<!-- src/app/pages/auth/register/register.component.html -->

<div class="register-container">
  <div class="register-card">
    <div class="register-header">
      <h1>El Sabor Lime√±o</h1>
      <p>Crear Cuenta Nueva</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
      <!-- Nombres -->
      <div class="form-group">
        <label for="nombres">Nombres *</label>
        <input
          id="nombres"
          type="text"
          formControlName="nombres"
          placeholder="Ingresa tus nombres"
          [class.error]="nombres?.invalid && nombres?.touched"
          />
          @if (nombres?.invalid && nombres?.touched) {
            <div class="error-message">
              @if (nombres?.errors?.['required']) {
                <span>Los nombres son requeridos</span>
              }
              @if (nombres?.errors?.['minlength']) {
                <span>M√≠nimo 2 caracteres</span>
              }
            </div>
          }
        </div>

        <!-- Apellidos -->
        <div class="form-group">
          <label for="apellidos">Apellidos *</label>
          <input
            id="apellidos"
            type="text"
            formControlName="apellidos"
            placeholder="Ingresa tus apellidos"
            [class.error]="apellidos?.invalid && apellidos?.touched"
            />
            @if (apellidos?.invalid && apellidos?.touched) {
              <div class="error-message">
                @if (apellidos?.errors?.['required']) {
                  <span>Los apellidos son requeridos</span>
                }
                @if (apellidos?.errors?.['minlength']) {
                  <span>M√≠nimo 2 caracteres</span>
                }
              </div>
            }
          </div>

          <!-- Email -->
          <div class="form-group">
            <label for="email">Correo Electr√≥nico *</label>
            <input
              id="email"
              type="email"
              formControlName="email"
              placeholder="ejemplo@correo.com"
              [class.error]="email?.invalid && email?.touched"
              />
              @if (email?.invalid && email?.touched) {
                <div class="error-message">
                  @if (email?.errors?.['required']) {
                    <span>El email es requerido</span>
                  }
                  @if (email?.errors?.['email']) {
                    <span>Email no v√°lido</span>
                  }
                </div>
              }
            </div>

            <!-- Tel√©fono -->
            <div class="form-group">
              <label for="telefono">Tel√©fono (Opcional)</label>
              <input
                id="telefono"
                type="tel"
                formControlName="telefono"
                placeholder="999999999"
                [class.error]="telefono?.invalid && telefono?.touched"
                />
                @if (telefono?.invalid && telefono?.touched) {
                  <div class="error-message">
                    @if (telefono?.errors?.['pattern']) {
                      <span>Debe tener entre 9 y 15 d√≠gitos</span>
                    }
                  </div>
                }
              </div>

              <!-- Password -->
              <div class="form-group">
                <label for="password">Contrase√±a *</label>
                <div class="password-input">
                  <input
                    id="password"
                    [type]="showPassword ? 'text' : 'password'"
                    formControlName="password"
                    placeholder="M√≠nimo 6 caracteres"
                    [class.error]="password?.invalid && password?.touched"
                    />
                    <button
                      type="button"
                      class="toggle-password"
                      (click)="togglePasswordVisibility()"
                      >
                      {{ showPassword ? 'üëÅÔ∏è' : 'üôà' }}
                    </button>
                  </div>
                  @if (password?.invalid && password?.touched) {
                    <div class="error-message">
                      @if (password?.errors?.['required']) {
                        <span>La contrase√±a es requerida</span>
                      }
                      @if (password?.errors?.['minlength']) {
                        <span>M√≠nimo 6 caracteres</span>
                      }
                    </div>
                  }
                </div>

                <!-- Confirm Password -->
                <div class="form-group">
                  <label for="confirmPassword">Confirmar Contrase√±a *</label>
                  <div class="password-input">
                    <input
                      id="confirmPassword"
                      [type]="showConfirmPassword ? 'text' : 'password'"
                      formControlName="confirmPassword"
                      placeholder="Repite tu contrase√±a"
                      [class.error]="(confirmPassword?.invalid && confirmPassword?.touched) || (registerForm.errors?.['passwordMismatch'] && confirmPassword?.touched)"
                      />
                      <button
                        type="button"
                        class="toggle-password"
                        (click)="toggleConfirmPasswordVisibility()"
                        >
                        {{ showConfirmPassword ? 'üëÅÔ∏è' : 'üôà' }}
                      </button>
                    </div>
                    @if (confirmPassword?.touched) {
                      <div class="error-message">
                        @if (confirmPassword?.errors?.['required']) {
                          <span>Confirma tu contrase√±a</span>
                        }
                        @if (registerForm.errors?.['passwordMismatch'] && !confirmPassword?.errors?.['required']) {
                          <span>
                            Las contrase√±as no coinciden
                          </span>
                        }
                      </div>
                    }
                  </div>

                  <!-- Error Message -->
                  @if (errorMessage) {
                    <div class="alert alert-danger">
                      ‚ö†Ô∏è {{ errorMessage }}
                    </div>
                  }

                  <!-- Submit Button -->
                  <button type="submit" class="btn-primary" [disabled]="loading || registerForm.invalid">
                    @if (!loading) {
                      <span>‚ú® Crear Cuenta</span>
                    }
                    @if (loading) {
                      <span>‚è≥ Creando cuenta...</span>
                    }
                  </button>

                  <!-- Links -->
                  <div class="register-links">
                    <p>
                      ¬øYa tienes cuenta?
                      <a routerLink="/login" class="link-primary">Inicia sesi√≥n aqu√≠</a>
                    </p>
                  </div>
                </form>
              </div>
            </div>
